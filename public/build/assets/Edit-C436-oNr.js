import{j as e}from"./app-BChuVOCF.js";import{r as a,u as r,H as s,L as t}from"./inertia-CDxxuqzl.js";import{A as l}from"./AuthenticatedLayout-lcZqL3KY.js";import{C as i}from"./church-CJMAxzbT.js";import{C as d}from"./calendar-C5Pn9FBq.js";import{F as n}from"./file-text-ARosyyTD.js";import{S as o}from"./save-BN6hmcxT.js";import{T as c}from"./trash-2-CUffOIhN.js";import{L as m}from"./loader-circle-DZI-om05.js";import{A as x}from"./arrow-left-CIT1mRxv.js";import"./vendor--zLKLCTa.js";import"./app-BTIiuZaC.js";import"./transition-tl5wXdCp.js";import"./users-CFzd3P2d.js";import"./x-CTmJfQPG.js";const u=[{value:"baptism",label:"Baptism"},{value:"eucharist",label:"First Holy Communion"},{value:"confirmation",label:"Confirmation"},{value:"reconciliation",label:"Reconciliation"},{value:"anointing",label:"Anointing of the Sick"},{value:"marriage",label:"Marriage"},{value:"holy_orders",label:"Holy Orders"}],h=({id:a,label:r,type:s="text",required:t=!1,placeholder:l="",className:i="",rows:d,data:n,errors:o,canEdit:c,handleFieldChange:m})=>{const x="textarea"===s;return e.jsxs("div",{className:i,children:[e.jsxs("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-2",children:[r," ",t&&e.jsx("span",{className:"text-red-500",children:"*"})]}),x?e.jsx("textarea",{id:a,value:n[a]||"",onChange:e=>m(a,e.target.value),placeholder:l,rows:d||3,disabled:!c,"aria-invalid":o[a]?"true":"false",className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${o[a]?"border-red-500":"border-gray-300"} ${c?"":"bg-gray-100 cursor-not-allowed"}`,required:t}):e.jsx("input",{type:s,id:a,value:n[a]||"",onChange:e=>m(a,e.target.value),placeholder:l,disabled:!c,"aria-invalid":o[a]?"true":"false",className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${o[a]?"border-red-500":"border-gray-300"} ${c?"":"bg-gray-100 cursor-not-allowed"}`,required:t,..."date"===s&&{max:(new Date).toISOString().split("T")[0]}}),o[a]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",role:"alert",children:o[a]})]})},p=({id:a,label:r,required:s=!1,placeholder:t="Select an option",className:l="",options:i,data:d,errors:n,canEdit:o,handleFieldChange:c})=>e.jsxs("div",{className:l,children:[e.jsxs("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-2",children:[r," ",s&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:a,value:d[a]||"",onChange:e=>c(a,e.target.value),disabled:!o,"aria-invalid":n[a]?"true":"false",className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${n[a]?"border-red-500":"border-gray-300"} ${o?"":"bg-gray-100 cursor-not-allowed"}`,required:s,children:[e.jsx("option",{value:"",children:t}),i.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),n[a]&&e.jsx("p",{className:"mt-1 text-sm text-red-600",role:"alert",children:n[a]})]});function b({auth:b,sacrament:g,members:j}){var f,y,v,N,w;const[_,C]=a.useState(!1),[S,F]=a.useState(!1),{data:E,setData:k,put:D,processing:q,errors:A,clearErrors:$,delete:B}=r({member_id:(null==(f=null==g?void 0:g.member_id)?void 0:f.toString())||"",sacrament_type:(null==g?void 0:g.sacrament_type)||"",date_administered:(null==g?void 0:g.date_administered)||"",administered_by:(null==g?void 0:g.administered_by)||"",location:(null==g?void 0:g.location)||"",certificate_number:(null==g?void 0:g.certificate_number)||"",witness_1:(null==g?void 0:g.witness_1)||"",witness_2:(null==g?void 0:g.witness_2)||"",notes:(null==g?void 0:g.notes)||""}),L=(null==(v=null==(y=null==b?void 0:b.user)?void 0:y.permissions)?void 0:v.can_edit_sacraments)??!0,R=(null==(w=null==(N=null==b?void 0:b.user)?void 0:N.permissions)?void 0:w.can_delete_sacraments)??!0,I=a.useCallback((e,a)=>{k(e,a),A[e]&&$(e)},[k,$]),U=a.useCallback(()=>{var e,a,r;const s=["member_id","sacrament_type","date_administered","administered_by","location"];for(const t of s)if(!(null==(e=E[t])?void 0:e.trim()))return null==(a=document.getElementById(t))||a.focus(),!1;if(E.date_administered){if(new Date(E.date_administered)>new Date)return null==(r=document.getElementById("date_administered"))||r.focus(),!1}return!0},[E]),H=a.useCallback(e=>{e.preventDefault(),U()&&($(),D(route("sacraments.update",g.id),{onError:e=>{var a;const r=Object.keys(e)[0];r&&(null==(a=document.getElementById(r))||a.focus())}}))},[U,$,D,g.id]),T=a.useCallback(()=>{(null==g?void 0:g.id)&&(F(!0),B(route("sacraments.destroy",g.id),{onError:()=>{F(!1),alert("Failed to delete sacrament record. Please try again.")},onFinish:()=>{F(!1),C(!1)}}))},[B,null==g?void 0:g.id]);return g?e.jsxs(l,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(t,{href:route("sacraments.index"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(x,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:[L?"Edit":"View"," Sacrament Record"]}),"                            ",e.jsxs("p",{className:"text-sm text-gray-600",children:[g.member.first_name," ",g.member.last_name," - ",g.sacrament_type]})]})]}),R&&e.jsxs("button",{onClick:()=>C(!0),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",disabled:S,children:[S?e.jsx(m,{className:"w-4 h-4 animate-spin"}):e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{children:S?"Deleting...":"Delete Record"})]})]}),children:[e.jsx(s,{title:`Edit Sacrament - ${g.sacrament_type}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[!L&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"You have read-only access. Contact an administrator to make changes."})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-purple-100 rounded-full p-2",children:e.jsx(i,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sacramental Information"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update the sacrament record details"})]})]})}),e.jsxs("form",{onSubmit:H,noValidate:!0,children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(p,{id:"sacrament_type",label:"Sacrament Type",required:!0,placeholder:"Select Sacrament",options:u,data:E,errors:A,canEdit:L,handleFieldChange:I}),e.jsx(p,{id:"member_id",label:"Member",required:!0,placeholder:"Select Member",options:j.map(e=>({value:e.id.toString(),label:`${e.first_name} ${e.last_name} (${e.member_number})`})),data:E,errors:A,canEdit:L,handleFieldChange:I})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(d,{className:"w-5 h-5 mr-2 text-purple-600"}),"Administration Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(h,{id:"date_administered",label:"Date Administered",type:"date",required:!0,data:E,errors:A,canEdit:L,handleFieldChange:I}),e.jsx(h,{id:"administered_by",label:"Administered By",required:!0,placeholder:"Name of priest/minister",data:E,errors:A,canEdit:L,handleFieldChange:I}),e.jsx(h,{id:"location",label:"Location",required:!0,placeholder:"Church name or location",className:"md:col-span-2",data:E,errors:A,canEdit:L,handleFieldChange:I})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(n,{className:"w-5 h-5 mr-2 text-purple-600"}),"Certificate & Witnesses"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(h,{id:"certificate_number",label:"Certificate Number",placeholder:"Certificate number (if any)",data:E,errors:A,canEdit:L,handleFieldChange:I}),e.jsx(h,{id:"witness_1",label:"Witness 1",placeholder:"First witness name",data:E,errors:A,canEdit:L,handleFieldChange:I}),e.jsx(h,{id:"witness_2",label:"Witness 2",placeholder:"Second witness name",data:E,errors:A,canEdit:L,handleFieldChange:I})]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsx(h,{id:"notes",label:"Additional Notes",type:"textarea",placeholder:"Any additional information about this sacrament...",rows:4,data:E,errors:A,canEdit:L,handleFieldChange:I})}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Record History"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(g.created_at).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Last Updated:"})," ",new Date(g.updated_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex justify-end items-center px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg space-x-3",children:[e.jsx(t,{href:route("sacraments.index"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:L?"Cancel":"Back to Sacraments"}),L&&e.jsxs("button",{type:"submit",disabled:q,className:"px-6 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg flex items-center space-x-2 transition-colors disabled:opacity-50",children:[e.jsx(o,{className:"w-4 h-4"}),e.jsx("span",{children:q?"Updating Record...":"Update Sacrament Record"})]})]})]})]})]})}),_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(c,{className:"w-6 h-6 text-red-600"})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete Sacrament Record"})})]}),e.jsxs("div",{className:"mb-4",children:["                            ",e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete this ",g.sacrament_type," record for"," ",e.jsxs("strong",{children:[g.member.first_name," ",g.member.last_name]}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>C(!1),disabled:S,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:T,disabled:S,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center justify-center space-x-2",children:S?e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Deleting..."})]}):e.jsx("span",{children:"Delete Record"})})]})]})})]}):e.jsxs(l,{children:[e.jsx(s,{title:"Sacrament Not Found"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("p",{className:"text-red-800",children:"Sacrament record not found or access denied."}),e.jsx(t,{href:route("sacraments.index"),className:"mt-4 inline-block bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Back to Sacraments"})]})})})]})}export{b as default};
