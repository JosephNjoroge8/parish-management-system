import{j as e}from"./app-BChuVOCF.js";import{u as s,r,H as a,L as t}from"./inertia-CDxxuqzl.js";import{A as i}from"./AuthenticatedLayout-lcZqL3KY.js";import{A as l}from"./arrow-left-CIT1mRxv.js";import{S as n}from"./save-BN6hmcxT.js";import{S as c,C as d,U as o,D as m,H as x}from"./users-CFzd3P2d.js";import{F as p}from"./file-text-ARosyyTD.js";import{D as u}from"./database-BKs6pQeq.js";import{S as g}from"./x-CTmJfQPG.js";import{A as h}from"./activity-Do-duXxG.js";import{U as b}from"./user-check-blNsQ-Pc.js";import"./vendor--zLKLCTa.js";import"./app-BTIiuZaC.js";import"./transition-tl5wXdCp.js";const v=e=>{switch(e.toLowerCase()){case"members":return"bg-blue-50 border-blue-200 text-blue-800";case"families":return"bg-green-50 border-green-200 text-green-800";case"users":return"bg-purple-50 border-purple-200 text-purple-800";case"sacraments":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"tithes":return"bg-emerald-50 border-emerald-200 text-emerald-800";case"activities":return"bg-orange-50 border-orange-200 text-orange-800";case"groups":return"bg-pink-50 border-pink-200 text-pink-800";case"reports":return"bg-indigo-50 border-indigo-200 text-indigo-800";case"settings":default:return"bg-gray-50 border-gray-200 text-gray-800";case"dashboard":return"bg-teal-50 border-teal-200 text-teal-800"}},j=[{name:"super-admin",display_name:"Super Administrator",description:"Full system access with all permissions",level:5,permissions:"*"},{name:"admin",display_name:"Administrator",description:"Administrative access with most permissions",level:4,permissions:["access *","manage *","view *","export *"]},{name:"manager",display_name:"Parish Manager",description:"Management level access for operations",level:3,permissions:["access members","manage members","access families","manage families","access sacraments","manage sacraments","access reports","view reports"]},{name:"secretary",display_name:"Parish Secretary",description:"Staff level access for daily operations",level:2,permissions:["access members","manage members","access families","manage families","access sacraments","create sacraments","edit sacraments"]},{name:"treasurer",display_name:"Parish Treasurer",description:"Financial management and reporting access",level:2,permissions:["access tithes","manage tithes","access reports","view financial reports","export reports"]},{name:"viewer",display_name:"Viewer",description:"Read-only access to basic information",level:1,permissions:["view members","view families","view sacraments","access dashboard"]}];function f({permissions:f}){var y,N,w;const{data:_,setData:A,post:C,processing:S,errors:k,reset:L}=s({name:"",display_name:"",description:"",permissions:[],clearance_level:1}),[D,R]=r.useState(""),[F,P]=r.useState(["members","dashboard"]),[W,O]=r.useState({}),M=()=>Object.values(f).flat().map(e=>e.name),T=e=>e.startsWith("manage")||e.startsWith("create")||e.startsWith("edit")||e.startsWith("delete")?"write":e.startsWith("view")||e.startsWith("access")?"read":e.startsWith("export")?"export":"other",U=e=>{switch(e){case"write":return"bg-red-100 text-red-800 border-red-200";case"read":return"bg-blue-100 text-blue-800 border-blue-200";case"export":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},q={total:Object.values(f).flat().length,selected:(null==(y=_.permissions)?void 0:y.length)||0,readOnly:(_.permissions||[]).filter(e=>"read"===T(e)).length,writeAccess:(_.permissions||[]).filter(e=>"write"===T(e)).length,exportAccess:(_.permissions||[]).filter(e=>"export"===T(e)).length};return e.jsxs(i,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(t,{href:route("admin.roles.index"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(l,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight flex items-center",children:[e.jsx(c,{className:"w-6 h-6 mr-2 text-blue-600"}),"Create New Role"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Define a new role with specific permissions and access levels"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-lg",children:[q.selected," of ",q.total," permissions selected"]})]}),children:[e.jsx(a,{title:"Create Role"}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),C(route("admin.roles.store"),{onSuccess:()=>{L()}})},className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Role Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Role Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",value:_.name,onChange:e=>A("name",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(k.name?"border-red-500":"border-gray-300"),placeholder:"e.g., parish-secretary",required:!0}),k.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:k.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use lowercase with hyphens (e.g., parish-manager)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"display_name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Display Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"display_name",value:_.display_name,onChange:e=>A("display_name",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(k.display_name?"border-red-500":"border-gray-300"),placeholder:"e.g., Parish Secretary",required:!0}),k.display_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:k.display_name})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{id:"description",rows:3,value:_.description,onChange:e=>A("description",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of this role's responsibilities and access level..."})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"clearance_level",className:"block text-sm font-medium text-gray-700 mb-2",children:"Clearance Level"}),e.jsxs("select",{id:"clearance_level",value:_.clearance_level,onChange:e=>A("clearance_level",parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:1,children:"Level 1 - Viewer (Read-only access)"}),e.jsx("option",{value:2,children:"Level 2 - Staff (Basic operations)"}),e.jsx("option",{value:3,children:"Level 3 - Manager (Management access)"}),e.jsx("option",{value:4,children:"Level 4 - Admin (Administrative access)"}),e.jsx("option",{value:5,children:"Level 5 - Super Admin (Full access)"})]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Permissions"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium text-blue-600",children:q.selected})," of ",q.total," selected"]}),e.jsx("button",{type:"button",onClick:()=>{var e;return A("permissions",(null==(e=_.permissions)?void 0:e.length)===q.total?[]:M())},className:"text-sm text-blue-600 hover:text-blue-800",children:(null==(N=_.permissions)?void 0:N.length)===q.total?"Deselect All":"Select All"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:q.readOnly}),e.jsx("div",{className:"text-xs text-blue-800",children:"Read Access"})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:q.writeAccess}),e.jsx("div",{className:"text-xs text-red-800",children:"Write Access"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:q.exportAccess}),e.jsx("div",{className:"text-xs text-green-800",children:"Export Access"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:q.selected}),e.jsx("div",{className:"text-xs text-gray-800",children:"Total Selected"})]})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(f).map(([s,r])=>{const a=(e=>{switch(e.toLowerCase()){case"members":case"groups":return o;case"families":return x;case"users":return b;case"sacraments":return c;case"tithes":return m;case"activities":return h;case"reports":return d;case"settings":return g;case"dashboard":return u;default:return p}})(s),t=F.includes(s),i=r.filter(e=>{var s;return null==(s=_.permissions)?void 0:s.includes(e.name)}).length;return e.jsxs("div",{className:`border border-gray-200 rounded-lg ${v(s)}`,children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-opacity-80 transition-colors",onClick:()=>(e=>{F.includes(e)?P(F.filter(s=>s!==e)):P([...F,e])})(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(a,{className:"w-5 h-5"}),e.jsx("h4",{className:"font-medium capitalize",children:s}),e.jsxs("span",{className:"text-sm",children:[i,"/",r.length," selected"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),((e,s)=>{const r=s.map(e=>e.name),a=_.permissions||[];if(r.every(e=>a.includes(e)))A("permissions",a.filter(e=>!r.includes(e))),O({...W,[e]:!1});else{const s=[...new Set([...a,...r])];A("permissions",s),O({...W,[e]:!0})}})(s,r)},className:"text-xs px-2 py-1 bg-white bg-opacity-50 rounded hover:bg-opacity-75 transition-colors",children:i===r.length?"Deselect All":"Select All"}),e.jsx("div",{className:"transform transition-transform "+(t?"rotate-180":""),children:e.jsx(l,{className:"w-4 h-4 rotate-90"})})]})]})}),t&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:r.map(s=>{var r;const a=null==(r=_.permissions)?void 0:r.includes(s.name),t=T(s.name);return e.jsxs("label",{className:"flex items-center space-x-2 p-2 bg-white bg-opacity-50 rounded hover:bg-opacity-75 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:()=>(e=>{const s=_.permissions||[];s.includes(e)?A("permissions",s.filter(s=>s!==e)):A("permissions",[...s,e])})(s.name),className:"rounded text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm flex-1",children:s.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${U(t)}`,children:t})]},s.id)})})})]},s)})}),k.permissions&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:k.permissions})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(t,{href:route("admin.roles.index"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:S,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center",children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),S?"Creating...":"Create Role"]})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6 sticky top-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Role Templates"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Quick start with predefined role templates"}),e.jsx("div",{className:"space-y-3",children:j.map(s=>e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors hover:bg-gray-50 "+(D===s.name?"border-blue-500 bg-blue-50":"border-gray-200"),onClick:()=>(e=>{R(e.name),A({..._,name:e.name,display_name:e.display_name,description:e.description,clearance_level:e.level,permissions:"*"===e.permissions?M():Array.isArray(e.permissions)?e.permissions:[]})})(s),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.display_name}),e.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:["Level ",s.level]})]}),e.jsx("p",{className:"text-xs text-gray-600",children:s.description})]},s.name))}),_.name&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Current Role Preview"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",_.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Display:"})," ",_.display_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Level:"})," ",_.clearance_level]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Permissions:"})," ",(null==(w=_.permissions)?void 0:w.length)||0]})]})]})]})})]})})})]})}export{f as default};
