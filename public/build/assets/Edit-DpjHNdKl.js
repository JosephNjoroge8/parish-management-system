import{j as e}from"./app-CE4iXgnb.js";import{r as s,u as a,H as r,L as l}from"./inertia-CDxxuqzl.js";import{A as t}from"./AuthenticatedLayout-CAzOOrEZ.js";import{H as i,U as d}from"./users-Dbj6gQ98.js";import{P as n}from"./phone-B6VxcByF.js";import{C as o}from"./calendar-jJpZne5F.js";import{S as c}from"./save-Bel763m4.js";import{T as m}from"./trash-2-DKnT_7c8.js";import{L as x}from"./loader-circle-ByBbcD6p.js";import{A as u}from"./arrow-left-kjLDD8xV.js";import{E as h}from"./eye-CYms5AqN.js";import"./vendor--zLKLCTa.js";import"./app-BHp0F1kE.js";import"./transition-tl5wXdCp.js";import"./user-plus-D75hMPXL.js";const g=({id:s,label:a,type:r="text",required:l=!1,placeholder:t="",className:i="",rows:d,value:n,error:o,onChange:c,canEdit:m=!0})=>{const x="textarea"===r;return e.jsxs("div",{className:i,children:[e.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-2",children:[a," ",l&&e.jsx("span",{className:"text-red-500",children:"*"})]}),x?e.jsx("textarea",{id:s,value:n,onChange:e=>c(e.target.value),placeholder:t,rows:d||3,disabled:!m,"aria-invalid":!!o,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${o?"border-red-500":"border-gray-300"} ${m?"":"bg-gray-100 cursor-not-allowed"}`,required:l}):e.jsx("input",{type:r,id:s,value:n,onChange:e=>c(e.target.value),placeholder:t,disabled:!m,"aria-invalid":!!o,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${o?"border-red-500":"border-gray-300"} ${m?"":"bg-gray-100 cursor-not-allowed"}`,required:l,..."date"===r&&{max:(new Date).toISOString().split("T")[0]}}),o&&e.jsx("p",{className:"mt-1 text-sm text-red-600",role:"alert",children:o})]})},p=({id:s,label:a,required:r=!1,placeholder:l="Select an option",className:t="",options:i,value:d,error:n,onChange:o,canEdit:c=!0})=>e.jsxs("div",{className:t,children:[e.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-2",children:[a," ",r&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:s,value:d,onChange:e=>o(e.target.value),disabled:!c,"aria-invalid":!!n,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${n?"border-red-500":"border-gray-300"} ${c?"":"bg-gray-100 cursor-not-allowed"}`,required:r,children:[e.jsx("option",{value:"",children:l}),i.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),n&&e.jsx("p",{className:"mt-1 text-sm text-red-600",role:"alert",children:n})]});function b({auth:b,family:f}){var j,y,v,N;const[w,_]=s.useState(!1),[C,F]=s.useState(!1),{data:E,setData:D,put:k,processing:A,errors:S,clearErrors:q,delete:I}=a({family_name:(null==f?void 0:f.family_name)||"",head_of_family:(null==f?void 0:f.head_of_family)||"",phone:(null==f?void 0:f.phone)||"",email:(null==f?void 0:f.email)||"",address:(null==f?void 0:f.address)||"",registration_date:(null==f?void 0:f.registration_date)||"",status:(null==f?void 0:f.status)||"active",notes:(null==f?void 0:f.notes)||""}),$=(null==(y=null==(j=null==b?void 0:b.user)?void 0:j.permissions)?void 0:y.can_edit_families)??!0,B=(null==(N=null==(v=null==b?void 0:b.user)?void 0:v.permissions)?void 0:N.can_delete_families)??!0,L=s.useCallback((e,s)=>{D(e,s),S[e]&&q(e)},[D,S,q]),U=s.useCallback(()=>{var e,s,a,r,l;const t=["family_name","head_of_family","registration_date","status"];for(const i of t)if(!(null==(e=E[i])?void 0:e.trim()))return null==(s=document.getElementById(i))||s.focus(),!1;if(null==(a=E.email)?void 0:a.trim()){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(E.email))return null==(r=document.getElementById("email"))||r.focus(),!1}if(E.registration_date){if(new Date(E.registration_date)>new Date)return null==(l=document.getElementById("registration_date"))||l.focus(),!1}return!0},[E]),T=s.useCallback(e=>{e.preventDefault(),U()&&(q(),k(route("families.update",f.id),{onError:e=>{var s;const a=Object.keys(e)[0];a&&(null==(s=document.getElementById(a))||s.focus())}}))},[U,q,k,f.id]),H=s.useCallback(()=>{(null==f?void 0:f.id)&&(F(!0),I(route("families.destroy",f.id),{onError:()=>{F(!1),alert("Failed to delete family. Please try again.")},onFinish:()=>{F(!1),_(!1)}}))},[I,null==f?void 0:f.id]);return f?e.jsxs(t,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(l,{href:route("families.index"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(u,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:[$?"Edit":"View"," Family: ",f.family_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[f.members_count," member",1!==f.members_count?"s":""]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(l,{href:route("families.show",f.id),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{children:"View Details"})]}),B&&e.jsxs("button",{onClick:()=>_(!0),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",disabled:C,children:[C?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(m,{className:"w-4 h-4"}),e.jsx("span",{children:C?"Deleting...":"Delete"})]})]})]}),children:[e.jsx(r,{title:`Edit ${f.family_name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[!$&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"You have read-only access. Contact an administrator to make changes."})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(i,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Family Information"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update the family information"})]})]})}),e.jsxs("form",{onSubmit:T,noValidate:!0,children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(g,{id:"family_name",label:"Family Name",required:!0,placeholder:"e.g., The Smith Family",value:E.family_name,error:S.family_name,onChange:e=>L("family_name",e),canEdit:$}),e.jsx(g,{id:"head_of_family",label:"Head of Family",required:!0,placeholder:"Full name of family head",value:E.head_of_family,error:S.head_of_family,onChange:e=>L("head_of_family",e),canEdit:$})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(n,{className:"w-5 h-5 mr-2 text-blue-600"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(g,{id:"phone",label:"Phone Number",type:"tel",placeholder:"+254 700 000 000",value:E.phone,error:S.phone,onChange:e=>L("phone",e),canEdit:$}),e.jsx(g,{id:"email",label:"Email Address",type:"email",placeholder:"family@email.com",value:E.email,error:S.email,onChange:e=>L("email",e),canEdit:$})]}),e.jsx("div",{className:"mt-6",children:e.jsx(g,{id:"address",label:"Address",type:"textarea",placeholder:"Full address including city and postal code",rows:3,value:E.address,error:S.address,onChange:e=>L("address",e),canEdit:$})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(o,{className:"w-5 h-5 mr-2 text-blue-600"}),"Registration Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(g,{id:"registration_date",label:"Registration Date",type:"date",required:!0,value:E.registration_date,error:S.registration_date,onChange:e=>L("registration_date",e),canEdit:$}),e.jsx(p,{id:"status",label:"Family Status",required:!0,options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],value:E.status,error:S.status,onChange:e=>L("status",e),canEdit:$})]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsx(g,{id:"notes",label:"Additional Notes",type:"textarea",placeholder:"Any additional information about this family...",rows:4,value:E.notes,error:S.notes,onChange:e=>L("notes",e),canEdit:$})}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Family History"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Created:"})," ",new Date(f.created_at).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Last Updated:"})," ",new Date(f.updated_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex justify-end items-center px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg space-x-3",children:[e.jsx(l,{href:route("families.index"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:$?"Cancel":"Back to Families"}),$&&e.jsxs("button",{type:"submit",disabled:A,className:"px-6 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg flex items-center space-x-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{children:A?"Updating Family...":"Update Family"})]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-2",children:e.jsx(d,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Family Members"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[f.members_count," member",1!==f.members_count?"s":""," in this family"]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(l,{href:route("members.index",{family_id:f.id}),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"View Members"}),e.jsx(l,{href:route("members.create",{family_id:f.id}),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Add Member"})]})]})})})]})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(m,{className:"w-6 h-6 text-red-600"})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete Family"})})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",e.jsx("strong",{children:f.family_name}),"? This will also remove all ",f.members_count," family member",1!==f.members_count?"s":"",". This action cannot be undone."]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>_(!1),disabled:C,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:H,disabled:C,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center justify-center space-x-2",children:C?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Deleting..."})]}):e.jsx("span",{children:"Delete Family"})})]})]})})]}):e.jsxs(t,{children:[e.jsx(r,{title:"Family Not Found"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("p",{className:"text-red-800",children:"Family not found or access denied."}),e.jsx(l,{href:route("families.index"),className:"mt-4 inline-block bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Back to Families"})]})})})]})}export{b as default};
