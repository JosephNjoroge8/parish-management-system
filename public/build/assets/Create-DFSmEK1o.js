import{j as e,C as s}from"./app-D-87LwF0.js";import{r,u as t,H as a,L as i}from"./inertia-CDxxuqzl.js";import{A as d}from"./AuthenticatedLayout-XalLJsaz.js";import{U as l}from"./users-bxVbXqF1.js";import{A as n}from"./arrow-left-tRuncKUE.js";import{C as c}from"./church-CNlB_6l-.js";import{C as o}from"./calendar-Cbz1jRnI.js";import{F as m}from"./file-text-P0tGijJR.js";import{S as x}from"./save-DeFa2VX8.js";import{C as u}from"./circle-alert-BgZRNbb9.js";import"./vendor--zLKLCTa.js";import"./app-iHDk2OQF.js";import"./transition-tl5wXdCp.js";import"./user-plus-CndCSYvC.js";const h=({id:r,label:t,type:a="text",required:i=!1,placeholder:d="",className:l="",rows:n,data:c,completedFields:o,fieldTouched:m,errors:x,handleFieldChange:h})=>{const g="textarea"===a,f=o.has(r),b=m.has(r),p=x[r];return e.jsxs("div",{className:`relative ${l}`,children:[e.jsx("label",{htmlFor:r,className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[t," ",i&&e.jsx("span",{className:"text-red-500",children:"*"})]}),f&&e.jsx(s,{className:"w-4 h-4 text-green-500"}),p&&b&&e.jsx(u,{className:"w-4 h-4 text-red-500"})]})}),g?e.jsx("textarea",{id:r,value:c[r]||"",onChange:e=>h(r,e.target.value),placeholder:d,rows:n||3,"aria-invalid":p?"true":"false",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 "+(p?"border-red-500 bg-red-50":f?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400"),required:i}):e.jsx("input",{type:a,id:r,value:c[r]||"",onChange:e=>h(r,e.target.value),placeholder:d,"aria-invalid":p?"true":"false",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 "+(p?"border-red-500 bg-red-50":f?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400"),required:i,..."date"===a&&{max:(new Date).toISOString().split("T")[0]}}),p&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",role:"alert",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),x[r]]}),i&&e.jsx("div",{className:"mt-1 w-full bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"h-1 rounded-full transition-all duration-300 "+(f?"bg-green-500 w-full":b?"bg-yellow-500 w-1/2":"bg-gray-300 w-0")})})]})};function g({auth:u,members:g=[],member_id:f}){const[b,p]=r.useState(""),[j,y]=r.useState(!1),[N,v]=r.useState(new Set),[w,_]=r.useState(new Set),[C,S]=r.useState(!1),F=Array.isArray(g)?g:[];r.useMemo(()=>{if(!b.trim())return F;const e=b.toLowerCase();return F.filter(s=>{var r;const t=`${s.first_name} ${s.last_name}`.toLowerCase(),a=(null==(r=s.id_number)?void 0:r.toLowerCase())||"",i=s.id.toString().toLowerCase();return t.includes(e)||a.includes(e)||i.includes(e)||s.first_name.toLowerCase().includes(e)||s.last_name.toLowerCase().includes(e)})},[b,F]);const{data:A,setData:T,post:E,processing:L,errors:D,clearErrors:k}=t({member_id:(()=>{if(!f||!F||0===F.length)return"";const e=F.find(e=>e.id===f);return e?e.id.toString():""})(),sacrament_type:"",date_administered:"",administered_by:"",location:"",certificate_number:"",witness_1:"",witness_2:"",notes:""});r.useEffect(()=>{const e=new Set;Object.entries(A).forEach(([s,r])=>{r&&""!==r.toString().trim()&&e.add(s)}),v(e)},[A]),r.useEffect(()=>{C&&Object.values(A).some(e=>""!==e)&&localStorage.setItem("sacrament_draft",JSON.stringify(A))},[A,C]),r.useEffect(()=>{const e=setTimeout(()=>{S(!0)},1e3);return()=>clearTimeout(e)},[]);const I=r.useCallback((e,s)=>{T(e,s),_(s=>new Set([...s,e])),D[e]&&k(e)},[T,k]);r.useEffect(()=>{if(A.sacrament_type&&!A.date_administered){const e=(new Date).toISOString().split("T")[0];T("date_administered",e)}},[A.sacrament_type,T]);const q=r.useCallback(()=>{var e,s,r;const t=["member_id","sacrament_type","date_administered","administered_by","location"];for(const a of t)if(!(null==(e=A[a])?void 0:e.trim()))return null==(s=document.getElementById(a))||s.focus(),!1;if(A.date_administered){if(new Date(A.date_administered)>new Date)return null==(r=document.getElementById("date_administered"))||r.focus(),!1}return!0},[A]),O=r.useCallback(e=>{e.preventDefault(),q()&&(k(),E(route("sacraments.store"),{onSuccess:()=>{localStorage.removeItem("sacrament_draft")},onError:e=>{const s=Object.keys(e)[0];if(s){const e=document.getElementById("member_id"===s?"member_search":s);null==e||e.focus()}}}))},[q,k,E,A]),R=Math.round(N.size/9*100);return 0===F.length?e.jsxs(d,{header:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(i,{href:route("sacraments.index"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(n,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Add New Sacramental Record"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Record a new sacrament administration"})]})]}),children:[e.jsx(a,{title:"Add New Sacrament"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx(l,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Members Available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You need to have registered members before you can create sacramental records."}),e.jsxs("div",{className:"space-x-4",children:[e.jsx(i,{href:route("members.create"),className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150",children:"Register New Member"}),e.jsx(i,{href:route("members.index"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest hover:bg-gray-50 focus:bg-gray-50 active:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150",children:"View Members"})]})]})})})]}):e.jsxs(d,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(i,{href:route("sacraments.index"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(n,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Add New Sacramental Record"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Record a new sacrament administration"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Progress: ",R,"%"]}),e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${R}%`}})})]})]}),children:[e.jsx(a,{title:"Add New Sacrament"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-purple-100 rounded-full p-2",children:e.jsx(c,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sacramental Information"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enter the details of the sacrament administration"})]})]}),C&&Object.values(A).some(e=>""!==e)&&e.jsxs("div",{className:"text-sm text-green-600 flex items-center",children:[e.jsx(s,{className:"w-4 h-4 mr-1"}),"Auto-saved"]})]})}),e.jsxs("form",{onSubmit:O,noValidate:!0,children:[e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(o,{className:"w-5 h-5 mr-2 text-purple-600"}),"Administration Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(h,{id:"date_administered",label:"Date Administered",type:"date",required:!0,data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I}),e.jsx(h,{id:"administered_by",label:"Administered By",required:!0,placeholder:"Name of priest/minister",data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I}),e.jsx(h,{id:"location",label:"Location",required:!0,placeholder:"Church name or location",className:"md:col-span-2",data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(m,{className:"w-5 h-5 mr-2 text-purple-600"}),"Certificate & Witnesses"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(h,{id:"certificate_number",label:"Certificate Number",placeholder:"Certificate number (if any)",data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I}),e.jsx(h,{id:"witness_1",label:"Witness 1",placeholder:"First witness name",data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I}),e.jsx(h,{id:"witness_2",label:"Witness 2",placeholder:"Second witness name",data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I})]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:e.jsx(h,{id:"notes",label:"Additional Notes",type:"textarea",placeholder:"Any additional information about this sacrament...",rows:4,data:A,completedFields:N,fieldTouched:w,errors:D,handleFieldChange:I})})]}),e.jsxs("div",{className:"flex justify-between items-center px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-lg",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[N.size,"/9 fields completed"]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(i,{href:route("sacraments.index"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:L||N.size<5,className:"px-6 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-400 text-white rounded-lg flex items-center space-x-2 transition-colors",children:[e.jsx(x,{className:"w-4 h-4"}),e.jsx("span",{children:L?"Creating Record...":"Create Sacrament Record"})]})]})]})]})]}),e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(l,{className:"w-5 h-5 text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Tips for faster data entry:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"• Start typing in any field to see suggestions"}),e.jsx("li",{children:"• Your progress is automatically saved as you type"}),e.jsx("li",{children:"• Use the search box to quickly find members"}),e.jsx("li",{children:"• Date suggestions are provided based on sacrament type"})]})]})]})})]})})]})}export{g as default};
