import{j as e,I as s,X as r}from"./app-CSiz3b5K.js";import{u as t,r as a,H as l,L as i}from"./inertia-CDxxuqzl.js";import{A as n}from"./AuthenticatedLayout-DT0Mn9x6.js";import{C as d}from"./circle-alert-AtuOFGsP.js";import{C as c}from"./crown-C2N-i-Ib.js";import{A as o}from"./arrow-left-CKloP-DQ.js";import{S as m}from"./save-wZAsqRcO.js";import{A as x}from"./award-C0UpPPFA.js";import{a as p,C as u,U as g,D as h,S as b,H as j}from"./users-CGfqwTuO.js";import{S as y}from"./user-plus-iz1tdUd0.js";import{U as f}from"./user-CAK_MpbU.js";import{F as v}from"./file-text-BqkznPc0.js";import{D as N}from"./database-jMdVGWT2.js";import{A as w}from"./activity-C62FfAJd.js";import{U as _}from"./user-check-CTPoY7mo.js";import"./vendor--zLKLCTa.js";import"./app-B5CVx4Nu.js";import"./transition-tl5wXdCp.js";const A=e=>{switch(e.toLowerCase()){case"members":return"bg-blue-50 border-blue-200 text-blue-800";case"families":return"bg-green-50 border-green-200 text-green-800";case"users":return"bg-purple-50 border-purple-200 text-purple-800";case"sacraments":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"tithes":return"bg-emerald-50 border-emerald-200 text-emerald-800";case"activities":return"bg-orange-50 border-orange-200 text-orange-800";case"groups":return"bg-pink-50 border-pink-200 text-pink-800";case"reports":return"bg-indigo-50 border-indigo-200 text-indigo-800";case"settings":default:return"bg-gray-50 border-gray-200 text-gray-800";case"dashboard":return"bg-teal-50 border-teal-200 text-teal-800"}},C=e=>{const s=e.toLowerCase();return s.includes("super")?5:s.includes("admin")?4:s.includes("manager")?3:s.includes("staff")||s.includes("secretary")||s.includes("treasurer")?2:1},S=e=>e.startsWith("manage")||e.startsWith("create")||e.startsWith("edit")||e.startsWith("delete")?"write":e.startsWith("view")||e.startsWith("access")?"read":e.startsWith("export")?"export":"other",k=e=>{switch(e){case"write":return"bg-red-100 text-red-800 border-red-200";case"read":return"bg-blue-100 text-blue-800 border-blue-200";case"export":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function L({role:L,permissions:D}){var R,W,O,F;const{data:P,setData:U,put:I,processing:E,errors:M,reset:T}=t({name:L.name||"",display_name:L.display_name||"",description:L.description||"",permissions:L.permissions||[],clearance_level:C(L.name)}),[$,q]=a.useState(["members","dashboard"]),[B,H]=a.useState({}),[z,V]=a.useState(!1),Y=(e=>{const s=e.toLowerCase();return s.includes("super")||s.includes("admin")?c:s.includes("manager")||s.includes("admin")?x:s.includes("staff")||s.includes("secretary")?p:s.includes("treasurer")?y:f})(L.name),G=(e,s)=>{U(e,s),V(!0)},J={total:Object.values(D).flat().length,selected:(null==(R=P.permissions)?void 0:R.length)||0,readOnly:(P.permissions||[]).filter(e=>"read"===S(e)).length,writeAccess:(P.permissions||[]).filter(e=>"write"===S(e)).length,exportAccess:(P.permissions||[]).filter(e=>"export"===S(e)).length};return e.jsxs(n,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(i,{href:route("admin.roles.show",L.id),className:"text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(o,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-gray-100",children:e.jsx(Y,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 leading-tight flex items-center",children:["Edit Role: ",L.display_name,z&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Unsaved Changes"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Modify role permissions and settings â€¢ ",L.users_count," users assigned"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[z&&e.jsxs("button",{type:"button",onClick:()=>{U({name:L.name,display_name:L.display_name,description:L.description||"",permissions:L.permissions,clearance_level:C(L.name)}),V(!1)},className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:[e.jsx(r,{className:"w-4 h-4 mr-2"}),"Reset"]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-lg",children:[J.selected," of ",J.total," permissions"]})]})]}),children:[e.jsx(l,{title:`Edit Role: ${L.display_name}`}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:["super-admin"===L.name&&e.jsxs("div",{className:"mb-6 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg flex items-center",children:[e.jsx(d,{className:"w-5 h-5 mr-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Warning:"})," You are editing the Super Admin role. Changes to this role affect system-wide administrative access."]})]}),L.users_count>0&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-100 border border-blue-400 text-blue-700 rounded-lg flex items-center",children:[e.jsx(s,{className:"w-5 h-5 mr-2"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Note:"})," This role is currently assigned to ",L.users_count," user(s). Changes will affect their access immediately."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),I(route("admin.roles.update",L.id),{onSuccess:()=>{V(!1)}})},className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Role Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Role Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",value:P.name,onChange:e=>G("name",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(M.name?"border-red-500":"border-gray-300"),placeholder:"e.g., parish-secretary",required:!0,disabled:"super-admin"===L.name}),M.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:M.name}),"super-admin"===L.name&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Super Admin role name cannot be changed"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"display_name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Display Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"display_name",value:P.display_name,onChange:e=>G("display_name",e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent "+(M.display_name?"border-red-500":"border-gray-300"),placeholder:"e.g., Parish Secretary",required:!0}),M.display_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:M.display_name})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{id:"description",rows:3,value:P.description,onChange:e=>G("description",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of this role's responsibilities and access level..."})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"clearance_level",className:"block text-sm font-medium text-gray-700 mb-2",children:"Clearance Level"}),e.jsxs("select",{id:"clearance_level",value:P.clearance_level,onChange:e=>G("clearance_level",parseInt(e.target.value)),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:"super-admin"===L.name,children:[e.jsx("option",{value:1,children:"Level 1 - Viewer (Read-only access)"}),e.jsx("option",{value:2,children:"Level 2 - Staff (Basic operations)"}),e.jsx("option",{value:3,children:"Level 3 - Manager (Management access)"}),e.jsx("option",{value:4,children:"Level 4 - Admin (Administrative access)"}),e.jsx("option",{value:5,children:"Level 5 - Super Admin (Full access)"})]}),"super-admin"===L.name&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Super Admin clearance level cannot be changed"})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Permissions"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium text-blue-600",children:J.selected})," of ",J.total," selected"]}),"super-admin"!==L.name&&e.jsx("button",{type:"button",onClick:()=>{var e;U("permissions",(null==(e=P.permissions)?void 0:e.length)===J.total?[]:Object.values(D).flat().map(e=>e.name)),V(!0)},className:"text-sm text-blue-600 hover:text-blue-800",children:(null==(W=P.permissions)?void 0:W.length)===J.total?"Deselect All":"Select All"})]})]}),"super-admin"===L.name&&e.jsx("div",{className:"mb-6 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{className:"w-5 h-5 text-purple-600 mr-2"}),e.jsxs("div",{className:"text-sm text-purple-800",children:[e.jsx("strong",{children:"Super Admin Role:"})," This role automatically has all permissions and cannot be restricted."]})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:J.readOnly}),e.jsx("div",{className:"text-xs text-blue-800",children:"Read Access"})]}),e.jsxs("div",{className:"bg-red-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:J.writeAccess}),e.jsx("div",{className:"text-xs text-red-800",children:"Write Access"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:J.exportAccess}),e.jsx("div",{className:"text-xs text-green-800",children:"Export Access"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:J.selected}),e.jsx("div",{className:"text-xs text-gray-800",children:"Total Selected"})]})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(D).map(([s,r])=>{const t=(e=>{switch(e.toLowerCase()){case"members":case"groups":return g;case"families":return j;case"users":return _;case"sacraments":return b;case"tithes":return h;case"activities":return w;case"reports":return u;case"settings":return y;case"dashboard":return N;default:return v}})(s),a=$.includes(s),l=r.filter(e=>{var s;return null==(s=P.permissions)?void 0:s.includes(e.name)}).length;return e.jsxs("div",{className:`border border-gray-200 rounded-lg ${A(s)}`,children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-opacity-80 transition-colors",onClick:()=>(e=>{$.includes(e)?q($.filter(s=>s!==e)):q([...$,e])})(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("h4",{className:"font-medium capitalize",children:s}),e.jsxs("span",{className:"text-sm",children:[l,"/",r.length," selected"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:["super-admin"!==L.name&&e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),((e,s)=>{const r=s.map(e=>e.name),t=P.permissions||[];if(r.every(e=>t.includes(e)))U("permissions",t.filter(e=>!r.includes(e))),H({...B,[e]:!1});else{const s=[...new Set([...t,...r])];U("permissions",s),H({...B,[e]:!0})}V(!0)})(s,r)},className:"text-xs px-2 py-1 bg-white bg-opacity-50 rounded hover:bg-opacity-75 transition-colors",children:l===r.length?"Deselect All":"Select All"}),e.jsx("div",{className:"transform transition-transform "+(a?"rotate-180":""),children:e.jsx(o,{className:"w-4 h-4 rotate-90"})})]})]})}),a&&e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:r.map(s=>{var r;const t=null==(r=P.permissions)?void 0:r.includes(s.name),a=S(s.name);return e.jsxs("label",{className:"flex items-center space-x-2 p-2 bg-white bg-opacity-50 rounded hover:bg-opacity-75 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:()=>"super-admin"!==L.name&&(e=>{const s=P.permissions||[];s.includes(e)?U("permissions",s.filter(s=>s!==e)):U("permissions",[...s,e]),V(!0)})(s.name),className:"rounded text-blue-600 focus:ring-blue-500",disabled:"super-admin"===L.name}),e.jsx("span",{className:"text-sm flex-1",children:s.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${k(a)}`,children:a})]},s.id)})})})]},s)})}),M.permissions&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:M.permissions})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(i,{href:route("admin.roles.show",L.id),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:E||!z,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),E?"Saving...":"Save Changes"]})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6 sticky top-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Role Info"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Original Name"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 font-mono bg-gray-50 px-2 py-1 rounded",children:L.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Users"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[L.users_count," users"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Original Permissions"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[L.permissions.length," permissions"]})]})]}),z&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-sm text-yellow-800 mb-2",children:"Pending Changes"}),e.jsxs("div",{className:"space-y-2 text-xs text-yellow-700",children:[P.name!==L.name&&e.jsxs("div",{children:["â€¢ Name: ",P.name]}),P.display_name!==L.display_name&&e.jsxs("div",{children:["â€¢ Display: ",P.display_name]}),(null==(O=P.permissions)?void 0:O.length)!==L.permissions.length&&e.jsxs("div",{children:["â€¢ Permissions: ",(null==(F=P.permissions)?void 0:F.length)||0," (was ",L.permissions.length,")"]})]})]})]})})]})]})})]})}export{L as default};
